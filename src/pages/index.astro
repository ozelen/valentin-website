---
import BaseLayout from '../layouts/BaseLayout.astro';
import { PERSONAL_INFO } from '../consts';
import { getCollection, render } from 'astro:content';

const roles = await getCollection('roles');
const sortedRoles = roles.sort((a, b) => (a.data.order || 0) - (b.data.order || 0));

const homeEntries = await getCollection('home');
const homeContent = homeEntries[0];
const { Content } = await render(homeContent);

const menuPages = await getCollection('pages');
const menuItems = menuPages
	.filter(page => page.data.showInMenu)
	.sort((a, b) => (a.data.menuOrder || 999) - (b.data.menuOrder || 999));
---

<BaseLayout
  title="Home"
  description="Professor of Economics (Econometrics) at The University of Queensland. Research in Productivity and Efficiency Analysis, Econometrics, and Performance Measurement."
>
  <!-- Hero Section with Full-Width Image -->
  <section class="relative -mt-20 md:-mt-24">
    <!-- Full-width hero image -->
    <div class="relative w-full h-[50vh] md:h-[80vh] md:min-h-[600px] md:max-h-[900px] overflow-hidden">
      <img
        src={PERSONAL_INFO.photo}
        alt={PERSONAL_INFO.name}
        class="w-full h-full object-cover object-top"
      />
      <!-- Overlay gradient - dark on sides, light in center -->
      <div class="absolute inset-0 bg-gradient-to-r from-gray-900/80 via-gray-900/20 to-gray-900/80"></div>
      
      <!-- Content overlay - Top section -->
      <div class="absolute inset-0 flex items-start pt-80">
        <div class="container-custom w-full flex justify-between items-start">
          <div class="max-w-2xl text-white">
            <h1 id="hero-name" class="text-xl md:text-2xl font-bold mb-4 drop-shadow-lg">
              {PERSONAL_INFO.name}
            </h1>
            <p class="text-sm md:text-lg text-gray-100 drop-shadow-md">{PERSONAL_INFO.title}</p>
            <p class="text-sm md:text-lg text-gray-200 mb-8 drop-shadow-md">{PERSONAL_INFO.affiliation}</p>
          </div>
          
          <!-- Right side menu -->
          <nav id="hero-menu" class="hidden lg:flex flex-col gap-3 text-right -mt-8">
            {menuItems.map((item) => (
              <a 
                href={item.data.path} 
                class="text-white/90 hover:text-white text-sm font-medium transition-all duration-300 drop-shadow-md hover:translate-x-[-4px] hover:opacity-100"
              >
                {item.data.menuLabel}
              </a>
            ))}
          </nav>
        </div>
      </div>
      
      <!-- Content overlay - Bottom section -->
      <!-- <div class="absolute inset-0 flex items-end pb-12">
        <div class="container-custom w-full">
          <div class="max-w-2xl text-white">
            <div class="text-sm text-gray-100 drop-shadow-md">
              <p>
                My research focuses on <strong>Productivity and Efficiency Analysis</strong>, 
                <strong>Econometrics & Business Analytics</strong>, and 
                <strong>Performance Measurement</strong> in healthcare and banking sectors.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div> -->
  </section>

  <!-- Current Roles - Overlapping with hero -->
  <section class="relative -mt-8 mb-8 z-10">
    <div class="container-custom">
      <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-4">
        {sortedRoles.map((role) => (
          <a
            href={`/about/roles/${role.id}`}
            class="bg-white/70 backdrop-blur-md rounded-lg border border-white/30 px-6 py-3 shadow-xl hover:bg-white/85 hover:shadow-2xl transition-all duration-300 group"
          >
            <h3 class="font-semibold text-gray-900 text-sm mb-1 group-hover:text-primary-600 transition-colors">
              {role.data.role}
            </h3>
            <p class="text-gray-700 text-xs leading-relaxed">{role.data.org}</p>
          </a>
        ))}
      </div>
    </div>
  </section>

  <!-- Hero Story -->
  <section class="bg-white py-4">
    <div class="container-custom">
      <div class="prose-custom max-w-4xl mx-auto">
        <Content />
      </div>
    </div>
  </section>

  <!-- Research Highlights -->
  <section class="py-16 bg-gray-50">
    <div class="container-custom">
      <h2 class="text-3xl font-bold text-gray-900 mb-8">Research Focus</h2>
      <div class="grid md:grid-cols-2 gap-8">
        <div class="bg-white p-6 rounded-lg border border-gray-200">
          <h3 class="text-xl font-semibold text-gray-900 mb-4">Core Areas</h3>
          <ul class="space-y-2 text-gray-700">
            <li>• Productivity and Efficiency Analysis (theory and applications)</li>
            <li>• Econometrics & Business Analytics (non-parametric, parametric)</li>
            <li>• Performance of Hospitals and Healthcare Analytics</li>
            <li>• Performance of Banks and Banking Analytics</li>
            <li>• Measurement of economic growth</li>
            <li>• Forecasting</li>
          </ul>
        </div>
        <div class="bg-white p-6 rounded-lg border border-gray-200">
          <h3 class="text-xl font-semibold text-gray-900 mb-4">Key Metrics</h3>
          <ul class="space-y-3 text-gray-700">
            <li>
              <span class="font-semibold">Publications:</span> 72+ peer-reviewed journal articles
            </li>
            <li>
              <span class="font-semibold">Top Journals:</span> Operations Research, Journal of Econometrics, EJOR
            </li>
            <li>
              <span class="font-semibold">REPEC Ranking:</span> Top 2-5% globally in Economics
            </li>
            <li>
              <span class="font-semibold">Field:</span> Top 2% in Efficiency & Productivity
            </li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <!-- Recent Highlights -->
  <section class="py-16 bg-white">
    <div class="container-custom">
      <h2 class="text-3xl font-bold text-gray-900 mb-8">Recent Highlights</h2>
      <div class="grid md:grid-cols-2 gap-6">
        <div class="card">
          <div class="flex items-start gap-4">
            <div class="flex-shrink-0 w-12 h-12 bg-primary-100 rounded-lg flex items-center justify-center">
              <svg class="w-6 h-6 text-primary-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
              </svg>
            </div>
            <div>
              <h3 class="font-semibold text-gray-900 mb-2">Recent Publications</h3>
              <p class="text-gray-600 text-sm mb-2">
                Multiple publications in top-tier journals including Operations Research, 
                Journal of Econometrics, and European Journal of Operational Research.
              </p>
              <a href="/publications" class="text-primary-600 hover:text-primary-700 text-sm font-medium">
                View all publications →
              </a>
            </div>
          </div>
        </div>
        
        <div class="card">
          <div class="flex items-start gap-4">
            <div class="flex-shrink-0 w-12 h-12 bg-primary-100 rounded-lg flex items-center justify-center">
              <svg class="w-6 h-6 text-primary-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
            </div>
            <div>
              <h3 class="font-semibold text-gray-900 mb-2">ARC Future Fellow</h3>
              <p class="text-gray-600 text-sm mb-2">
                Awarded ARC Future Fellowship (2017-2021) for research on improving productivity 
                in Australian hospitals.
              </p>
              <a href="/service" class="text-primary-600 hover:text-primary-700 text-sm font-medium">
                Learn more →
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</BaseLayout>
