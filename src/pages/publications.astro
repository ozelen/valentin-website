---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

const publications = await getCollection('publications');
const featured = publications.filter(p => p.data.featured).sort((a, b) => b.data.year - a.data.year);
const journals = publications.filter(p => p.data.type === 'journal').sort((a, b) => b.data.year - a.data.year);
const books = publications.filter(p => p.data.type === 'book').sort((a, b) => b.data.year - a.data.year);
const chapters = publications.filter(p => p.data.type === 'chapter').sort((a, b) => b.data.year - a.data.year);
const workingPapers = publications.filter(p => p.data.type === 'working-paper').sort((a, b) => b.data.year - a.data.year);
---

<BaseLayout
	title="Publications"
	description="Research publications including journal articles, books, book chapters, and working papers by Valentin Zelenyuk."
>
	<div class="container-custom py-16">
		<h1 class="text-4xl font-bold text-gray-900 mb-8">Publications</h1>

		<!-- Featured Publications -->
		{featured.length > 0 && (
			<section class="mb-12">
				<h2 class="text-2xl font-bold text-gray-900 mb-6">Featured Publications</h2>
				<div class="space-y-4">
					{featured.map((pub) => (
						<div class="card">
							<div class="flex items-start justify-between gap-4">
								<div class="flex-1">
									<h3 class="text-lg font-semibold text-gray-900 mb-2">
										{pub.data.title}
									</h3>
									<p class="text-gray-600 mb-2">{pub.data.authors}</p>
									{pub.data.journal && (
										<p class="text-sm text-gray-700 mb-2">
											<em>{pub.data.journal}</em>
											{pub.data.volume && `, ${pub.data.volume}`}
											{pub.data.pages && `, ${pub.data.pages}`}
											{` (${pub.data.year})`}
										</p>
									)}
									<div class="flex flex-wrap gap-3 mt-3">
										{pub.data.pdf && (
											<a href={pub.data.pdf} target="_blank" rel="noopener" class="text-sm text-primary-600 hover:text-primary-700">
												PDF
											</a>
										)}
										{pub.data.doi && (
											<a href={pub.data.doi} target="_blank" rel="noopener" class="text-sm text-primary-600 hover:text-primary-700">
												DOI
											</a>
										)}
										{pub.data.arxiv && (
											<a href={pub.data.arxiv} target="_blank" rel="noopener" class="text-sm text-primary-600 hover:text-primary-700">
												arXiv
											</a>
										)}
									</div>
								</div>
								{pub.data.journalRank && (
									<span class="px-2 py-1 text-xs font-semibold rounded bg-primary-100 text-primary-800">
										{pub.data.journalRank}
									</span>
								)}
							</div>
						</div>
					))}
				</div>
			</section>
		)}

		<!-- Journal Articles -->
		<section class="mb-12">
			<h2 class="text-2xl font-bold text-gray-900 mb-6">Peer-Reviewed Journal Articles</h2>
			<div class="space-y-4">
				{journals.length > 0 ? (
					journals.map((pub) => (
						<div class="card">
							<div class="flex items-start justify-between gap-4">
								<div class="flex-1">
									<h3 class="text-lg font-semibold text-gray-900 mb-2">
										{pub.data.title}
									</h3>
									<p class="text-gray-600 mb-2">{pub.data.authors}</p>
									<p class="text-sm text-gray-700 mb-2">
										<em>{pub.data.journal}</em>
										{pub.data.volume && `, ${pub.data.volume}`}
										{pub.data.issue && `(${pub.data.issue})`}
										{pub.data.pages && `, ${pub.data.pages}`}
										{` (${pub.data.year})`}
									</p>
									<div class="flex flex-wrap gap-3 mt-3">
										{pub.data.pdf && (
											<a href={pub.data.pdf} target="_blank" rel="noopener" class="text-sm text-primary-600 hover:text-primary-700">
												PDF
											</a>
										)}
										{pub.data.doi && (
											<a href={pub.data.doi} target="_blank" rel="noopener" class="text-sm text-primary-600 hover:text-primary-700">
												DOI
											</a>
										)}
									</div>
								</div>
								{pub.data.journalRank && (
									<span class="px-2 py-1 text-xs font-semibold rounded bg-primary-100 text-primary-800 whitespace-nowrap">
										{pub.data.journalRank}
									</span>
								)}
							</div>
						</div>
					))
				) : (
					<p class="text-gray-600">Publications will be added here. See the CV for the complete list.</p>
				)}
			</div>
		</section>

		<!-- Books -->
		{books.length > 0 && (
			<section class="mb-12">
				<h2 class="text-2xl font-bold text-gray-900 mb-6">Books & Monographs</h2>
				<div class="space-y-4">
					{books.map((pub) => (
						<div class="card">
							<h3 class="text-lg font-semibold text-gray-900 mb-2">
								{pub.data.title}
							</h3>
							<p class="text-gray-600 mb-2">{pub.data.authors}</p>
							<p class="text-sm text-gray-700 mb-2">
								{pub.data.publisher && `${pub.data.publisher}, `}
								{`${pub.data.year}`}
							</p>
							{pub.data.doi && (
								<a href={pub.data.doi} target="_blank" rel="noopener" class="text-sm text-primary-600 hover:text-primary-700">
									Publisher Link
								</a>
							)}
						</div>
					))}
				</div>
			</section>
		)}

		<!-- Book Chapters -->
		{chapters.length > 0 && (
			<section class="mb-12">
				<h2 class="text-2xl font-bold text-gray-900 mb-6">Book Chapters</h2>
				<div class="space-y-4">
					{chapters.map((pub) => (
						<div class="card">
							<h3 class="text-lg font-semibold text-gray-900 mb-2">
								{pub.data.title}
							</h3>
							<p class="text-gray-600 mb-2">{pub.data.authors}</p>
							<p class="text-sm text-gray-700">
								In: <em>{pub.data.journal || pub.data.publisher}</em>
								{` (${pub.data.year})`}
							</p>
						</div>
					))}
				</div>
			</section>
		)}

		<!-- Working Papers -->
		{workingPapers.length > 0 && (
			<section>
				<h2 class="text-2xl font-bold text-gray-900 mb-6">Working Papers</h2>
				<div class="space-y-4">
					{workingPapers.map((pub) => (
						<div class="card">
							<h3 class="text-lg font-semibold text-gray-900 mb-2">
								{pub.data.title}
							</h3>
							<p class="text-gray-600 mb-2">{pub.data.authors}</p>
							<div class="flex flex-wrap gap-3 mt-3">
								{pub.data.pdf && (
									<a href={pub.data.pdf} target="_blank" rel="noopener" class="text-sm text-primary-600 hover:text-primary-700">
										PDF
									</a>
								)}
								{pub.data.ssrn && (
									<a href={pub.data.ssrn} target="_blank" rel="noopener" class="text-sm text-primary-600 hover:text-primary-700">
										SSRN
									</a>
								)}
								{pub.data.arxiv && (
									<a href={pub.data.arxiv} target="_blank" rel="noopener" class="text-sm text-primary-600 hover:text-primary-700">
										arXiv
									</a>
								)}
							</div>
						</div>
					))}
				</div>
			</section>
		)}

		<div class="mt-12 p-6 bg-gray-50 rounded-lg">
			<p class="text-gray-700">
				<strong>Note:</strong> This is a selected list. For the complete publication record, 
				please see the <a href="/cv" class="text-primary-600 hover:text-primary-700">full CV</a> 
				or visit <a href="https://scholar.google.com/citations?user=KBGcuJEAAAAJ&hl=en" 
				target="_blank" rel="noopener" class="text-primary-600 hover:text-primary-700">Google Scholar</a>.
			</p>
		</div>
	</div>
</BaseLayout>

